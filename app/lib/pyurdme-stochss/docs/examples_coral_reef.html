<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PyURDME Example: Coral Reef &mdash; PyURDME 1.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PyURDME 1.0.1 documentation" href="index.html" />
    <link rel="up" title="PyURDME Examples" href="examples.html" />
    <link rel="prev" title="PyURDME Example: Cell Polarization in Yeast" href="examples_yeast_polarization.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="examples_yeast_polarization.html" title="PyURDME Example: Cell Polarization in Yeast"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PyURDME 1.0.1 documentation</a> &raquo;</li>
          <li><a href="examples.html" accesskey="U">PyURDME Examples</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pyurdme-example-coral-reef">
<h1>PyURDME Example:  Coral Reef<a class="headerlink" href="#pyurdme-example-coral-reef" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This model of space competiinot between Macro Algae (MA) and Coral (C) is a 2D periodic domain representing a patch of reef.  Mature Coral colonys produce mobile propagules, which diffuse. Same with Macro Algae  When a propagule find a open Turf space (T), it creates a new mature version of it&#8217;s species.  Mature version are able to grow locally filling the free Turf within each voxel, but are unable to spread beyond voxel the border. It must depend on the mobile propagules for that.</p>
</div>
<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pyurdme</span>


<span class="k">class</span> <span class="nc">CoralReef</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">URDMEModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Model developed by Briggs and Drawert 3/31/2014, based on a </span>
<span class="sd">        non-spatial model by Briggs and Adam.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;coral_reef&quot;</span><span class="p">,</span> <span class="n">D_c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">D_m</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">pyurdme</span><span class="o">.</span><span class="n">URDMEModel</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

        <span class="c"># Species</span>
        <span class="n">Coral</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Coral&quot;</span><span class="p">,</span><span class="n">diffusion_constant</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">Coral_m</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Coral_m&quot;</span><span class="p">,</span><span class="n">diffusion_constant</span><span class="o">=</span><span class="n">D_c</span><span class="p">)</span>
        <span class="n">MA</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;MA&quot;</span><span class="p">,</span> <span class="n">diffusion_constant</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">MA_m</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;MA_m&quot;</span><span class="p">,</span> <span class="n">diffusion_constant</span><span class="o">=</span><span class="n">D_m</span><span class="p">)</span>
        <span class="n">Turf</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Turf&quot;</span><span class="p">,</span> <span class="n">diffusion_constant</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_species</span><span class="p">([</span><span class="n">Coral</span><span class="p">,</span> <span class="n">MA</span><span class="p">,</span> <span class="n">Coral_m</span><span class="p">,</span> <span class="n">MA_m</span><span class="p">,</span> <span class="n">Turf</span><span class="p">])</span>

        <span class="c"># Parameters</span>
        <span class="n">phi_c</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;phi_c&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">0.0011</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="n">phi_m</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;phi_m&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="n">g_tc</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;g_tc&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="n">g_tm</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;g_tm&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="n">Gamma</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Gamma&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">dc</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;dc&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="n">dm</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;dm&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="c">#dm = pyurdme.Parameter(name=&quot;dm&quot;, expression=0.2) #1/year</span>
        <span class="n">phi_g</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;psi_g&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="c"># Death rate of mobile propgules.  Combine with diffusion to determine spread.</span>
        <span class="n">mu_c</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;mu_c&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="n">mu_m</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;mu_m&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="c"># mobile propogules destroyed by estabilished </span>
        <span class="n">alpha_c</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;alpha_c&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="n">alpha_m</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;alpha_m&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="c"># Production of mobile propogules</span>
        <span class="n">R_c</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R_c&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> <span class="c">#1/year</span>
        <span class="n">R_m</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R_m&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> <span class="c">#1/year</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">([</span><span class="n">phi_c</span><span class="p">,</span> <span class="n">phi_m</span><span class="p">,</span> <span class="n">g_tc</span><span class="p">,</span> <span class="n">g_tm</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">phi_g</span><span class="p">,</span> <span class="n">mu_c</span><span class="p">,</span> <span class="n">mu_m</span><span class="p">,</span> <span class="n">alpha_c</span><span class="p">,</span> <span class="n">alpha_m</span><span class="p">,</span> <span class="n">R_c</span><span class="p">,</span> <span class="n">R_m</span><span class="p">])</span>
                

        <span class="c"># Reactions:</span>
        <span class="c"># C -&gt; T : dc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R3&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">Coral</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">Turf</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">rate</span><span class="o">=</span><span class="n">dc</span><span class="p">))</span>
        <span class="c"># MA -&gt; T : dm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R4&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">MA</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">Turf</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">rate</span><span class="o">=</span><span class="n">dm</span><span class="p">))</span>
        <span class="c"># T + C_m -&gt; C : phi_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R5&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">Turf</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">Coral_m</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">Coral</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">rate</span><span class="o">=</span><span class="n">phi_c</span><span class="p">))</span>
        <span class="c"># T + MA_m -&gt; MA : phi_m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R6&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">Turf</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">MA_m</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">MA</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">rate</span><span class="o">=</span><span class="n">phi_m</span><span class="p">))</span>
        <span class="c"># C + T -&gt; 2C : g_tc * exp(-1.0 * psi_g * MA / 100)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R7&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">Turf</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">Coral</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">Coral</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="n">propensity_function</span><span class="o">=</span><span class="s">&quot;g_tc*Turf*Coral*exp(-1.0 * psi_g * MA / Space_per_voxel)/vol&quot;</span><span class="p">))</span>
        <span class="c"># MA + T -&gt; 2MA : g_tm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R8&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">Turf</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">MA</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">MA</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="n">rate</span><span class="o">=</span><span class="n">g_tm</span><span class="p">))</span>
        <span class="c"># C + MA -&gt; 2MA : Gamma * g_tm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R9&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">Coral</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">MA</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">MA</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="n">propensity_function</span><span class="o">=</span><span class="s">&quot;g_tm*Gamma*Coral*MA/vol&quot;</span><span class="p">))</span>
        <span class="c"># C -&gt; C + C_m : R_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R10&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">Coral</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">Coral</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">Coral_m</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">rate</span><span class="o">=</span><span class="n">R_c</span><span class="p">))</span>
        <span class="c"># MA -&gt; MA + MA_m : R_m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R11&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">MA</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">MA</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">MA_m</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">rate</span><span class="o">=</span><span class="n">R_m</span><span class="p">))</span>
        <span class="c"># C_m -&gt; 0 : mu_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R12&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">Coral_m</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">products</span><span class="o">=</span><span class="p">{},</span> <span class="n">rate</span><span class="o">=</span><span class="n">mu_c</span><span class="p">))</span>
        <span class="c"># MA_m -&gt; 0 : mu_m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R13&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">MA_m</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>  <span class="n">products</span><span class="o">=</span><span class="p">{},</span> <span class="n">rate</span><span class="o">=</span><span class="n">mu_m</span><span class="p">))</span>
        <span class="c"># MA + C_m -&gt; MA : alpha_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R14&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">MA</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">Coral_m</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>  <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">MA</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">rate</span><span class="o">=</span><span class="n">alpha_c</span><span class="p">))</span>
        <span class="c"># C + MA_m -&gt; C : alpha_m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;R15&quot;</span><span class="p">,</span> <span class="n">reactants</span><span class="o">=</span><span class="p">{</span><span class="n">Coral</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">MA_m</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>  <span class="n">products</span><span class="o">=</span><span class="p">{</span><span class="n">Coral</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">rate</span><span class="o">=</span><span class="n">alpha_m</span><span class="p">))</span>
 
        

        <span class="c"># A unit square</span>
        <span class="c"># each grid point is 10cm x 10cm, domain is 5m x 5m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">pyurdme</span><span class="o">.</span><span class="n">URDMEMesh</span><span class="o">.</span><span class="n">generate_square_mesh</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">Space_per_voxel</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">pyurdme</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Space_per_voxel&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="n">Space_per_voxel</span><span class="p">))</span> <span class="c">#1/year</span>
        
                          
        <span class="k">if</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># Start with two colonys</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_initial_condition_distribute_uniformly</span><span class="p">({</span><span class="n">Turf</span><span class="p">:</span><span class="n">Space_per_voxel</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_initial_condition_place_near</span><span class="p">({</span><span class="n">Coral</span><span class="p">:</span><span class="n">Space_per_voxel</span><span class="p">},</span> <span class="n">point</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_initial_condition_place_near</span><span class="p">({</span><span class="n">Turf</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span> <span class="n">point</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_initial_condition_place_near</span><span class="p">({</span><span class="n">MA</span><span class="p">:</span><span class="n">Space_per_voxel</span><span class="p">},</span> <span class="n">point</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_initial_condition_place_near</span><span class="p">({</span><span class="n">Turf</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span> <span class="n">point</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Every voxel is the same</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_initial_condition_distribute_uniformly</span><span class="p">({</span><span class="n">Turf</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_initial_condition_distribute_uniformly</span><span class="p">({</span><span class="n">Coral</span><span class="p">:</span><span class="n">Space_per_voxel</span><span class="o">-</span><span class="mi">1</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_initial_condition_distribute_uniformly</span><span class="p">({</span><span class="n">MA</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>


        <span class="k">for</span> <span class="n">vndx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">tot</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">sndx</span><span class="p">,</span> <span class="n">sname</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listOfSpecies</span><span class="p">):</span>
                <span class="n">tot</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span><span class="p">[</span><span class="n">sndx</span><span class="p">][</span><span class="n">vndx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">tot</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">sndx</span><span class="p">,</span> <span class="n">sname</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listOfSpecies</span><span class="p">):</span>
                    <span class="k">print</span> <span class="s">&quot;u0[{0}][{1}] = {2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sname</span><span class="p">,</span> <span class="n">vndx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span><span class="p">[</span><span class="n">sndx</span><span class="p">][</span><span class="n">vndx</span><span class="p">])</span>

        <span class="c">#self.timespan(numpy.linspace(0,500,501)) #500 years</span>
        <span class="c">#self.timespan(numpy.linspace(0,5,72)) #5 years, by months</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timespan</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">66</span><span class="p">))</span> <span class="c">#10 years, by 2 months</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">CoralReef</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">report_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&quot;Writing PavaView compatable output to &#39;output_coral&#39; directory&quot;</span>
    <span class="n">result</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="s">&#39;Coral&#39;</span><span class="p">,</span><span class="n">folder_name</span><span class="o">=</span><span class="s">&quot;output_coral&quot;</span><span class="p">)</span>

    <span class="n">x_vals</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">y_vals</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">C_vals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_species</span><span class="p">(</span><span class="s">&quot;Coral&quot;</span><span class="p">)</span>
    <span class="n">MA_vals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_species</span><span class="p">(</span><span class="s">&quot;MA&quot;</span><span class="p">)</span>
    <span class="n">Turf_vals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_species</span><span class="p">(</span><span class="s">&quot;Turf&quot;</span><span class="p">)</span>
    <span class="n">num_vox</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)</span>    

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">tndx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c">#show end timepoint</span>
    <span class="n">tval</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tspan</span><span class="p">[</span><span class="n">tndx</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">heatmap</span><span class="p">,</span> <span class="n">xedges</span><span class="p">,</span> <span class="n">yedges</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">C_vals</span><span class="p">[</span><span class="n">tndx</span><span class="p">,:],</span> <span class="n">bins</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_vox</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;Coral population&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;t={0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tval</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">heatmap</span><span class="p">,</span> <span class="n">xedges</span><span class="p">,</span> <span class="n">yedges</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">MA_vals</span><span class="p">[</span><span class="n">tndx</span><span class="p">,:],</span> <span class="n">bins</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_vox</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;MA population&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;t={0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tval</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">heatmap</span><span class="p">,</span> <span class="n">xedges</span><span class="p">,</span> <span class="n">yedges</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">Turf_vals</span><span class="p">[</span><span class="n">tndx</span><span class="p">,:],</span> <span class="n">bins</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_vox</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;Free Turf&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;t={0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tval</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">PyURDME Example:  Coral Reef</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="examples_yeast_polarization.html"
                        title="previous chapter">PyURDME Example: Cell Polarization in Yeast</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/examples_coral_reef.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="examples_yeast_polarization.html" title="PyURDME Example: Cell Polarization in Yeast"
             >previous</a> |</li>
        <li><a href="index.html">PyURDME 1.0.1 documentation</a> &raquo;</li>
          <li><a href="examples.html" >PyURDME Examples</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Brian Drawert, Andreas Hellander.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b3.
    </div>
  </body>
</html>